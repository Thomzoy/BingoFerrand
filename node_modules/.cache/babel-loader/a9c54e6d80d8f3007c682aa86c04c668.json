{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.weak-set.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.some.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.compileGeneralSelector = void 0;\n\nvar attributes_1 = require(\"./attributes\");\n\nvar pseudo_selectors_1 = require(\"./pseudo-selectors\");\n\nvar css_what_1 = require(\"css-what\");\n/*\n * All available rules\n */\n\n\nfunction compileGeneralSelector(next, selector, options, context, compileToken) {\n  var adapter = options.adapter,\n      equals = options.equals;\n\n  switch (selector.type) {\n    case css_what_1.SelectorType.PseudoElement:\n      {\n        throw new Error(\"Pseudo-elements are not supported by css-select\");\n      }\n\n    case css_what_1.SelectorType.ColumnCombinator:\n      {\n        throw new Error(\"Column combinators are not yet supported by css-select\");\n      }\n\n    case css_what_1.SelectorType.Attribute:\n      {\n        if (selector.namespace != null) {\n          throw new Error(\"Namespaced attributes are not yet supported by css-select\");\n        }\n\n        if (!options.xmlMode || options.lowerCaseAttributeNames) {\n          selector.name = selector.name.toLowerCase();\n        }\n\n        return attributes_1.attributeRules[selector.action](next, selector, options);\n      }\n\n    case css_what_1.SelectorType.Pseudo:\n      {\n        return (0, pseudo_selectors_1.compilePseudoSelector)(next, selector, options, context, compileToken);\n      }\n    // Tags\n\n    case css_what_1.SelectorType.Tag:\n      {\n        if (selector.namespace != null) {\n          throw new Error(\"Namespaced tag names are not yet supported by css-select\");\n        }\n\n        var name_1 = selector.name;\n\n        if (!options.xmlMode || options.lowerCaseTags) {\n          name_1 = name_1.toLowerCase();\n        }\n\n        return function tag(elem) {\n          return adapter.getName(elem) === name_1 && next(elem);\n        };\n      }\n    // Traversal\n\n    case css_what_1.SelectorType.Descendant:\n      {\n        if (options.cacheResults === false || typeof WeakSet === \"undefined\") {\n          return function descendant(elem) {\n            var current = elem;\n\n            while (current = adapter.getParent(current)) {\n              if (adapter.isTag(current) && next(current)) {\n                return true;\n              }\n            }\n\n            return false;\n          };\n        } // @ts-expect-error `ElementNode` is not extending object\n\n\n        var isFalseCache_1 = new WeakSet();\n        return function cachedDescendant(elem) {\n          var current = elem;\n\n          while (current = adapter.getParent(current)) {\n            if (!isFalseCache_1.has(current)) {\n              if (adapter.isTag(current) && next(current)) {\n                return true;\n              }\n\n              isFalseCache_1.add(current);\n            }\n          }\n\n          return false;\n        };\n      }\n\n    case \"_flexibleDescendant\":\n      {\n        // Include element itself, only used while querying an array\n        return function flexibleDescendant(elem) {\n          var current = elem;\n\n          do {\n            if (adapter.isTag(current) && next(current)) return true;\n          } while (current = adapter.getParent(current));\n\n          return false;\n        };\n      }\n\n    case css_what_1.SelectorType.Parent:\n      {\n        return function parent(elem) {\n          return adapter.getChildren(elem).some(function (elem) {\n            return adapter.isTag(elem) && next(elem);\n          });\n        };\n      }\n\n    case css_what_1.SelectorType.Child:\n      {\n        return function child(elem) {\n          var parent = adapter.getParent(elem);\n          return parent != null && adapter.isTag(parent) && next(parent);\n        };\n      }\n\n    case css_what_1.SelectorType.Sibling:\n      {\n        return function sibling(elem) {\n          var siblings = adapter.getSiblings(elem);\n\n          for (var i = 0; i < siblings.length; i++) {\n            var currentSibling = siblings[i];\n            if (equals(elem, currentSibling)) break;\n\n            if (adapter.isTag(currentSibling) && next(currentSibling)) {\n              return true;\n            }\n          }\n\n          return false;\n        };\n      }\n\n    case css_what_1.SelectorType.Adjacent:\n      {\n        if (adapter.prevElementSibling) {\n          return function adjacent(elem) {\n            var previous = adapter.prevElementSibling(elem);\n            return previous != null && next(previous);\n          };\n        }\n\n        return function adjacent(elem) {\n          var siblings = adapter.getSiblings(elem);\n          var lastElement;\n\n          for (var i = 0; i < siblings.length; i++) {\n            var currentSibling = siblings[i];\n            if (equals(elem, currentSibling)) break;\n\n            if (adapter.isTag(currentSibling)) {\n              lastElement = currentSibling;\n            }\n          }\n\n          return !!lastElement && next(lastElement);\n        };\n      }\n\n    case css_what_1.SelectorType.Universal:\n      {\n        if (selector.namespace != null && selector.namespace !== \"*\") {\n          throw new Error(\"Namespaced universal selectors are not yet supported by css-select\");\n        }\n\n        return next;\n      }\n  }\n}\n\nexports.compileGeneralSelector = compileGeneralSelector;","map":{"version":3,"sources":["/home/thomas/Code/BingoFerrand/node_modules/css-select/lib/general.js"],"names":["Object","defineProperty","exports","value","compileGeneralSelector","attributes_1","require","pseudo_selectors_1","css_what_1","next","selector","options","context","compileToken","adapter","equals","type","SelectorType","PseudoElement","Error","ColumnCombinator","Attribute","namespace","xmlMode","lowerCaseAttributeNames","name","toLowerCase","attributeRules","action","Pseudo","compilePseudoSelector","Tag","name_1","lowerCaseTags","tag","elem","getName","Descendant","cacheResults","WeakSet","descendant","current","getParent","isTag","isFalseCache_1","cachedDescendant","has","add","flexibleDescendant","Parent","parent","getChildren","some","Child","child","Sibling","sibling","siblings","getSiblings","i","length","currentSibling","Adjacent","prevElementSibling","adjacent","previous","lastElement","Universal"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.compileGeneralSelector = void 0;\nvar attributes_1 = require(\"./attributes\");\nvar pseudo_selectors_1 = require(\"./pseudo-selectors\");\nvar css_what_1 = require(\"css-what\");\n/*\n * All available rules\n */\nfunction compileGeneralSelector(next, selector, options, context, compileToken) {\n    var adapter = options.adapter, equals = options.equals;\n    switch (selector.type) {\n        case css_what_1.SelectorType.PseudoElement: {\n            throw new Error(\"Pseudo-elements are not supported by css-select\");\n        }\n        case css_what_1.SelectorType.ColumnCombinator: {\n            throw new Error(\"Column combinators are not yet supported by css-select\");\n        }\n        case css_what_1.SelectorType.Attribute: {\n            if (selector.namespace != null) {\n                throw new Error(\"Namespaced attributes are not yet supported by css-select\");\n            }\n            if (!options.xmlMode || options.lowerCaseAttributeNames) {\n                selector.name = selector.name.toLowerCase();\n            }\n            return attributes_1.attributeRules[selector.action](next, selector, options);\n        }\n        case css_what_1.SelectorType.Pseudo: {\n            return (0, pseudo_selectors_1.compilePseudoSelector)(next, selector, options, context, compileToken);\n        }\n        // Tags\n        case css_what_1.SelectorType.Tag: {\n            if (selector.namespace != null) {\n                throw new Error(\"Namespaced tag names are not yet supported by css-select\");\n            }\n            var name_1 = selector.name;\n            if (!options.xmlMode || options.lowerCaseTags) {\n                name_1 = name_1.toLowerCase();\n            }\n            return function tag(elem) {\n                return adapter.getName(elem) === name_1 && next(elem);\n            };\n        }\n        // Traversal\n        case css_what_1.SelectorType.Descendant: {\n            if (options.cacheResults === false ||\n                typeof WeakSet === \"undefined\") {\n                return function descendant(elem) {\n                    var current = elem;\n                    while ((current = adapter.getParent(current))) {\n                        if (adapter.isTag(current) && next(current)) {\n                            return true;\n                        }\n                    }\n                    return false;\n                };\n            }\n            // @ts-expect-error `ElementNode` is not extending object\n            var isFalseCache_1 = new WeakSet();\n            return function cachedDescendant(elem) {\n                var current = elem;\n                while ((current = adapter.getParent(current))) {\n                    if (!isFalseCache_1.has(current)) {\n                        if (adapter.isTag(current) && next(current)) {\n                            return true;\n                        }\n                        isFalseCache_1.add(current);\n                    }\n                }\n                return false;\n            };\n        }\n        case \"_flexibleDescendant\": {\n            // Include element itself, only used while querying an array\n            return function flexibleDescendant(elem) {\n                var current = elem;\n                do {\n                    if (adapter.isTag(current) && next(current))\n                        return true;\n                } while ((current = adapter.getParent(current)));\n                return false;\n            };\n        }\n        case css_what_1.SelectorType.Parent: {\n            return function parent(elem) {\n                return adapter\n                    .getChildren(elem)\n                    .some(function (elem) { return adapter.isTag(elem) && next(elem); });\n            };\n        }\n        case css_what_1.SelectorType.Child: {\n            return function child(elem) {\n                var parent = adapter.getParent(elem);\n                return parent != null && adapter.isTag(parent) && next(parent);\n            };\n        }\n        case css_what_1.SelectorType.Sibling: {\n            return function sibling(elem) {\n                var siblings = adapter.getSiblings(elem);\n                for (var i = 0; i < siblings.length; i++) {\n                    var currentSibling = siblings[i];\n                    if (equals(elem, currentSibling))\n                        break;\n                    if (adapter.isTag(currentSibling) && next(currentSibling)) {\n                        return true;\n                    }\n                }\n                return false;\n            };\n        }\n        case css_what_1.SelectorType.Adjacent: {\n            if (adapter.prevElementSibling) {\n                return function adjacent(elem) {\n                    var previous = adapter.prevElementSibling(elem);\n                    return previous != null && next(previous);\n                };\n            }\n            return function adjacent(elem) {\n                var siblings = adapter.getSiblings(elem);\n                var lastElement;\n                for (var i = 0; i < siblings.length; i++) {\n                    var currentSibling = siblings[i];\n                    if (equals(elem, currentSibling))\n                        break;\n                    if (adapter.isTag(currentSibling)) {\n                        lastElement = currentSibling;\n                    }\n                }\n                return !!lastElement && next(lastElement);\n            };\n        }\n        case css_what_1.SelectorType.Universal: {\n            if (selector.namespace != null && selector.namespace !== \"*\") {\n                throw new Error(\"Namespaced universal selectors are not yet supported by css-select\");\n            }\n            return next;\n        }\n    }\n}\nexports.compileGeneralSelector = compileGeneralSelector;\n"]},"metadata":{},"sourceType":"script"}